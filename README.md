forked from: https://github.com/goldshtn/etrace
